<!DOCTYPE html>
<html>
<head>

    <meta charset="utf-8" />
    <title>Gamedev</title>
    <style>

        body, html {
            width: 100%;
            height: 100%;
            margin: 0px;
            overflow: hidden;
        }
        canvas {
            background-color: black;
        }
    </style>

</head>


<body>

<canvas id="myCanvas"></canvas>

<div id="game_over" style="display: none;" align="center">
    <p>Hey this is some invisble content! Pretty scary! D:</p>
</div>

<script>
    // init canvas
    var canvas = document.getElementById("myCanvas");
    var ctx = canvas.getContext("2d");

    // Snake attribute vars
    var starting_x = 45;
    var starting_y = 45;
    var snake_head = [starting_x, starting_y, "#ffffff"];
    var snake_body = [];
    var snake_speed = 20;
    var snake_speed_increase = 20;
    var snake_size = 15;
    var snake_length = 10;

    // Movement var
    var movement = 0;

    // Food vars
    var food_size_x = 0;
    var food_size_y = 0;
    var create_new_food = true;

    // Sound vars
    // var sound_game_over_beep = new Audio("gm_over.wav");
    // var sound_food_eat_beep = new Audio("gm_eat.wav");

    // Key vars
    var up_pressed = false; // w = 87     up arrow = 38
    var left_pressed = false; // a = 65    left arrow = 37 +
    var down_pressed = false; // s = 83   down arrow = 40
    var right_pressed = false; // d = 68  right arrow = 39+
    var escape_pressed = false;// esc = 27

    document.addEventListener("keydown",keyDownHandler,false);



    // done defining vars


    function keyDownHandler(e){
        if(e.keyCode==39 || e.keyCode==68){ // right arrow / d

            right_pressed = true;
            up_pressed = false;
            down_pressed = false;
            left_pressed = false;
            escape_pressed = false;
        }
        else if(e.keyCode==37 || e.keyCode==65){ // left arrow / a

            left_pressed = true;
            right_pressed = false;
            up_pressed = false;
            down_pressed = false;
            escape_pressed = false;
        }
        else if(e.keyCode==38 || e.keyCode==87){ // down arrow / s

            down_pressed = true;
            left_pressed = false;
            right_pressed = false;
            up_pressed = false;
            escape_pressed = false;
        }
        else if(e.keyCode==40 || e.keyCode==83) { // up arrow / w

            up_pressed = true;
            down_pressed = false;
            left_pressed = false;
            right_pressed = false;
            escape_pressed = false;
        }
        else if(e.keyCode==27){ // esc

                escape_pressed = true;
                up_pressed = false;
                down_pressed = false;
                left_pressed = false;
                right_pressed = false;
        }
        }




            function game_over_notification(){
                clearInterval(game_loop);
                document.getElementById("game_over").style.visibility = "visible";
                document.location.reload();

            }


            function snake_draw(){
                for(var i = snake_body.length - 1; i >= 0; i--){
                    ctx.beginPath();
                    ctx.rect(snake_body[i][0],snake_body[i][1], snake_size, snake_size);
                    ctx.fillStyle = "#ffffff";
                    ctx.fill();
                    ctx.closePath();

                }
            }

            function valid_pos(cord){
                var x = cord[0];
                var y = cord[1];
                if(x > (ctx.canvas.width + snake_size/2) || x <= (0 - snake_size/2) || y > (ctx.canvas.length + snake_size/2) || y <= 0 - snake_size/2){
                    return false;
                }
                return true;
            }
            function  snake_calculate_pos(){
                var x = snake_head[0];
                var y = snake_head[1];
                if(right_pressed){
                    snake_head = [(x + snake_speed), y]
                } else if(left_pressed){
                    snake_head = [(x - snake_speed), y]
                } else if(up_pressed){
                    snake_head = [x, (y + snake_speed)]
                } else if(down_pressed){
                    snake_head = [x, (y - snake_speed)]
                }
                snake_body.push(snake_head);
                while(snake_body.length > snake_length){
                    snake_body.shift();
                }
            }
            function create_food(){
                var x = Math.floor((Math.random() * (window.innerWidth)) + 1);
                var y = Math.floor((Math.random() * (window.innerHeight)) + 1);
                var food_cords = [x, y]
            }

            function food_draw(){
                if(create_new_food == true){
                    create_new_food = false;
                    create_food()
                }
            }

            function draw(){
                // This code is for resizing the window
                var ctx = canvas.getContext("2d");
                ctx.canvas.width  = (window.innerWidth);
                ctx.canvas.height = (window.innerHeight);
                // end block

                if(escape_pressed == false) {
                    snake_calculate_pos();
                    snake_body.push(snake_head);
                    if (valid_pos(snake_head) == false) {
                        game_over_notification();
                    }
                }
                snake_draw();
            }

            var game_loop = setInterval(draw, 100);
</script>

</body>
</html>